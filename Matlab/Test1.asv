% Definiera alla konstanter
% Sätter igång snurran
F = 1;             % Kraften som appliceras
delta_t = 0.1;     % Tiden under vilken en kraft appliceras

% Snurrans egenskaper
mass = 0.1;                 % Snurrans massa
r = 0.02;                   % Snurrans radie (längst upp)
h = 0.07;                   % Snurrans höjd
com = 3 * height / 4;       % Avståndet till masscentrum
g = 9.82;                   % Gravitationskonstanten


% Trögehtsmoment
I1 = mass * ((3/20)*r*r + (3/80)*h*h);  % Tröghetsmoment vid lutning
I3 = (3*mass*r*r)/10; % Tröghetsmoment när rak (Vertikal om underlaget)
                  
% Beräkna psi_dot
psi_dot = F*r*delta_t/I3;

% Beräkna phi_dot
phi_dot = mass*g*com/(psi_dot*I1);


H= 1 / 60; % step's size
N=5000; % number of steps

% Startvärden för psi och phi
psi(1) = 0;
phi(1) = 0;

% For-loop för att beräkna allt möjligt med hjälp av Euler (eller tidigare
% vinklar)
for n=1:N
    
    psi(n+1) = Euler(psi(n), psi_dot, H);
    phi(n+1) = Euler(phi(n), phi_dot, H);
    
end

% Plotta resultaten från loopen ovan.
t = 0:H:H*N;
plot(t,mod(psi,2*pi),'r');
title('Psi');
figure;
plot(t,mod(phi,2*pi),'r');
title('Phi');
figure;
plot(t,theta,'r');
title('Theta');
% figure;
% plot(t,phi_dot,'r');
% figure;
% plot(t,theta_dot,'r');

% Märkte när jag körde denna nedan att mittensnurren ändrar riktning efter en
% stund och börjar gå åt andra hållet. Vet ej vad det beror på. Den andra
% rör sig jättesakta, känns inte heller så bra.
% 
% for n =1:N
%     plot(r*cos(psi(n)), r*sin(psi(n)), '*');
%     axis([-1 1 -1 1]);
%     hold on;
%     plot(cos(phi(n)), sin(phi(n)), '*');
%     drawnow();
% end